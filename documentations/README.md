# מערכת הסעות עובדים 🚌

מערכת ניהול מקיפה לניהול הסעות יומיות, מסלולים, עובדים ונהגים. המערכת בנויה כ-Single Page Application (SPA) ב-vanilla JavaScript ללא צורך בתהליך בנייה.

## 📋 תוכן עניינים

- [תכונות עיקריות](#תכונות-עיקריות)
- [התקנה והפעלה](#התקנה-והפעלה)
- [שימוש ראשוני](#שימוש-ראשוני)
- [מבנה הפרויקט](#מבנה-הפרויקט)
- [תיעוד](#תיעוד)
- [דרישות מערכת](#דרישות-מערכת)
- [תמיכה](#תמיכה)

## ✨ תכונות עיקריות

### ניהול עובדים
- ✅ הוספה, עריכה ומחיקה של עובדים
- ✅ ייבוא עובדים מקובץ Excel/ODS
- ✅ ייצוא רשימת עובדים ל-Excel
- ✅ ניהול פרטי עובדים מלאים (כתובת, טלפון, מסלול, שעת איסוף)
- ✅ מערכת הרשאות (עובד, מנהל, מנהל מערכת)

### ניהול מסלולים
- ✅ יצירה ועריכה של מסלולי נסיעה
- ✅ מפה אינטראקטיבית עם Leaflet.js
- ✅ חיפוש כתובות אוטומטי
- ✅ ניהול נקודות איסוף

### סידור הסעות
- ✅ הקצאת עובדים לנהגים ומסלולים
- ✅ ממשק גרירה ושחרור (Drag & Drop)
- ✅ סימון עובדים שלא יגיעו היום
- ✅ שליחת סידור לנהגים

### דוחות וסטטיסטיקות
- ✅ דוח נסיעות חודשי
- ✅ סטטיסטיקות שימוש במסלולים
- ✅ אחוז ביטולים
- ✅ ייצוא דוחות ל-Excel

### התראות ועדכונים
- ✅ פרסום התראות לעובדים ונהגים
- ✅ מחיקה אוטומטית של התראות ישנות (אחרי 4 ימים)
- ✅ תצוגה בדשבורד

### אימות והרשאות
- ✅ התחברות עם שם משתמש/קוד עובד
- ✅ רישום עובדים חדשים
- ✅ איפוס סיסמה דרך אימייל (EmailJS)
- ✅ קובץ נפרד מהיר לאיפוס סיסמה (`index.html`)
- ✅ מערכת הרשאות מובנית

## 🚀 התקנה והפעלה

### דרישות מוקדמות
- דפדפן מודרני (Chrome, Firefox, Edge, Safari, Opera GX)
- חיבור לאינטרנט (למפות ותלויות CDN)

### התקנה

1. **שכפל או הורד את הפרויקט**
   ```bash
   git clone <repository-url>
   cd omri_project
   ```

2. **פתח את הקובץ בדפדפן**
   - פתח את `transport-system.html` בדפדפן
   - או הגש דרך שרת אינטרנט (מומלץ לייצור)

3. **התחל להשתמש**
   - המערכת תטען עם נתוני דוגמה
   - התחבר עם אחד מהעובדים הקיימים או צור משתמש חדש

### הערות חשובות

- ⚠️ **חיבור לאינטרנט נדרש** לטעינת ספריות חיצוניות (Tailwind CSS, Font Awesome, Leaflet, SheetJS)
- ⚠️ **HTTPS מומלץ** בייצור (נדרש לחלק מממשקי API כמו Geolocation)
- 💾 **כל הנתונים נשמרים ב-localStorage** של הדפדפן - ייצא גיבויים באופן קבוע!

## 📖 שימוש ראשוני

### התחברות למערכת

1. פתח את `transport-system.html` בדפדפן
2. במסך ההתחברות, הזן:
   - **שם משתמש** או **קוד עובד** (למשל: "בן אליהו")
   - **סיסמה**
3. לחץ על **"התחברות"**

### יצירת עובד חדש

1. לחץ על **"הרשמה"** במסך ההתחברות
2. מלא את כל השדות הנדרשים
3. לחץ על **"הרשמה"**

### ייבוא עובדים מ-Excel

1. עבור ל**"רשימת עובדים"**
2. לחץ על **"ייבוא עובדים"**
3. בחר קובץ Excel/ODS
4. המערכת תזהה אוטומטית את הפורמט ותייבא את העובדים

> 💡 **טיפ**: לחץ על כפתור **"?"** ליד כפתור הייבוא כדי לראות את הפורמט המדויק הנדרש

### יצירת מסלול חדש

1. עבור ל**"ניהול מסלולים"**
2. לחץ על **"מסלול חדש"**
3. הזן שם למסלול
4. לחץ על המפה או הזן כתובת כדי להוסיף נקודות
5. לחץ על **"שמור מסלול"**

## 📁 מבנה הפרויקט

```
omri_project/
├── transport-system.html      # קובץ המערכת הראשי (כל הקוד)
├── index.html                 # קובץ איפוס סיסמה (קובץ נפרד קטן ומהיר)
├── documentations/
│   ├── README.md              # קובץ זה - מידע כללי על הפרויקט
│   ├── DOCUMENTATION.md       # תיעוד טכני מפורט למפתחים
│   └── תיעוד_שימוש.md        # מדריך שימוש למשתמשים
```

### מבנה הקוד ב-transport-system.html

```
transport-system.html
├── HTML Structure             # מבנה HTML בסיסי
├── CSS Styles                 # Tailwind CSS + עיצוב מותאם אישית
└── JavaScript
    ├── Configuration          # הגדרות (צבעים, EmailJS, SMS)
    ├── Data Models            # מערכי נתונים (עובדים, נהגים)
    ├── State Variables        # משתני מצב גלובליים
    ├── Storage Functions      # פונקציות localStorage
    ├── Business Logic         # לוגיקה עסקית
    ├── View Components         # רכיבי תצוגה (10 מסכים)
    ├── Modal Components        # רכיבי מודלים
    └── Event Handlers          # מטפלי אירועים

index.html (קובץ איפוס סיסמה)
├── HTML Structure             # מבנה HTML מינימלי
├── CSS Styles                 # Tailwind CSS
└── JavaScript
    ├── Configuration          # הגדרות (צבעים)
    ├── Load Employees         # טעינת עובדים מ-localStorage
    ├── Token Verification     # אימות טוקן איפוס סיסמה
    ├── Password Reset UI      # מסך איפוס סיסמה
    └── Save Password          # שמירת סיסמה חדשה
```

## 📚 תיעוד

הפרויקט כולל שני קבצי תיעוד:

### 1. תיעוד שימוש (`תיעוד_שימוש.md`)
מדריך מפורט למשתמשי קצה בעברית, כולל:
- הוראות שימוש בכל התכונות
- הסבר על כל המסכים והתפריטים
- טיפים ופתרון בעיות
- הוראות ייבוא/ייצוא Excel

### 2. תיעוד טכני (`DOCUMENTATION.md`)
תיעוד מפורט למפתחים בעברית, כולל:
- סקירת ארכיטקטורה
- מבני נתונים
- API של כל הפונקציות
- נקודות הרחבה
- שיקולי ביצועים ואבטחה

## 🖥️ דרישות מערכת

### דפדפנים נתמכים
- ✅ Chrome/Edge (גרסה אחרונה)
- ✅ Firefox (גרסה אחרונה)
- ✅ Safari (גרסה אחרונה)
- ✅ Opera GX (גרסה אחרונה)

### תכונות נדרשות
- ES6+ JavaScript support
- localStorage API
- FileReader API
- Drag & Drop API
- CSS Grid & Flexbox

### תלויות חיצוניות (נטענות מ-CDN)
- **Tailwind CSS** - עיצוב UI
- **Font Awesome 6.4.0** - אייקונים
- **SheetJS (XLSX) 0.18.5** - טיפול בקבצי Excel/ODS
- **Leaflet.js 1.9.4** - מפות אינטראקטיביות
- **EmailJS Browser SDK 4** - שליחת אימיילים (אופציונלי)

## 🔧 תכונות מתקדמות

### ייבוא Excel חכם
- זיהוי אוטומטי של כותרות
- תמיכה בפורמטים שונים (עם/בלי כותרות, אנכי/אופקי)
- עדכון עובדים קיימים במקום יצירת כפילויות

### ניהול מסלולים עם מפה
- מפה אינטראקטיבית מבוססת OpenStreetMap
- חיפוש כתובות אוטומטי
- הוספת נקודות על ידי לחיצה על המפה

### דוחות חודשיים
- חישוב אוטומטי של סטטיסטיקות
- פירוט לפי מסלול
- ייצוא ל-Excel

### מערכת הרשאות
- תמיכה בשלוש רמות: עובד, מנהל, מנהל מערכת
- הגבלת גישה לפי תפקיד
- מוכנה להרחבה

### איפוס סיסמה דרך אימייל
- שליחת אימייל איפוס סיסמה דרך EmailJS (חינמי עד 200/חודש)
- קובץ נפרד מהיר (`index.html`) לאיפוס סיסמה
- טוקן מאובטח עם email hash ו-timestamp
- תמיכה בדומיינים שונים (cross-domain)
- תוקף טוקן: שעה אחת

## 💾 גיבוי ושחזור

### גיבוי נתונים
כל הנתונים נשמרים ב-localStorage של הדפדפן. כדי לגבות:

1. **ייצוא עובדים**: עבור ל"רשימת עובדים" → לחץ על "ייצוא עובדים"
2. **שמירת קובץ HTML**: שמור עותק של `transport-system.html`
3. **גיבוי localStorage**: השתמש בתוסף דפדפן לגיבוי localStorage

### שחזור נתונים
1. ייבא את קובץ ה-Excel עם העובדים
2. או שחזר את localStorage מהגיבוי

> ⚠️ **חשוב**: ייצא גיבויים באופן קבוע! נתונים ב-localStorage עלולים להימחק אם מנקים את נתוני הדפדפן.

## 🔒 אבטחה

### מצב נוכחי
- סיסמאות מאוחסנות בטקסט פשוט ב-localStorage
- אימות מתבצע רק בצד הלקוח
- כל הנתונים מאוחסנים מקומית בדפדפן

### המלצות לייצור
1. **הצפנת סיסמאות**: יישם bcrypt או דומה
2. **אימות בצד שרת**: העבר אימות ל-backend
3. **HTTPS**: השתמש ב-HTTPS בייצור
4. **אימות קלט**: כבר מיושם בצד הלקוח

## 🐛 פתרון בעיות

### בעיות נפוצות

**עובדים לא מופיעים אחרי ייבוא**
- רענן את הדף (F5)
- ודא שפורמט הקובץ נכון (לחץ על "?" ליד כפתור הייבוא)

**מפה לא נטענת**
- ודא שיש חיבור לאינטרנט
- בדוק את קונסולת הדפדפן לשגיאות

**נתונים נעלמו אחרי רענון**
- בדוק ש-localStorage פעיל בדפדפן
- ייצא גיבויים באופן קבוע

**דוח לא מייצא**
- בדוק את הגדרות ההורדה האוטומטית בדפדפן
- בדפדפן Opera GX, ודא שההורדות לא חסומות

## 📝 רישיון

פרויקט זה הוא קוד פתוח וזמין לשימוש חופשי.

## 👥 תרומה

תרומות מתקבלות בברכה! אם מצאת באג או יש לך רעיון לשיפור:

1. פתח issue עם תיאור הבעיה/הרעיון
2. או צור Pull Request עם השינויים

## 📞 תמיכה

לשאלות ותמיכה:
- עיין ב-[תיעוד השימוש](תיעוד_שימוש.md) למדריך מפורט
- עיין ב-[תיעוד הטכני](DOCUMENTATION.md) למידע למפתחים
- פתח issue בפרויקט

## 🎯 תכונות עתידיות

- [ ] יישום מלא של מערכת הרשאות
- [ ] אינטגרציה עם API בצד שרת
- [ ] עדכונים בזמן אמת (WebSockets)
- [ ] אפליקציה ניידת (PWA)
- [ ] דיווח מתקדם יותר
- [ ] התראות אימייל/SMS

## 🙏 תודות

תודה לכל התורמים והמשתמשים של המערכת!

---

**גרסה**: 0.9 (Beta)  
**עודכן לאחרונה**: 2026  
**מפות**: [OpenStreetMap](https://www.openstreetmap.org/)  
**אייקונים**: [Font Awesome](https://fontawesome.com/)

---

<div dir="rtl">

**מערכת הסעות עובדים** - פתרון מקיף לניהול הסעות יומיות

</div>
